"""
PII 검출 테스트 케이스 Part 2 (TC023~TC056)
Categories: 주민등록번호, 여권번호/운전면허번호, 이메일, IP주소

난이도:
  - EASY   : 표준 형식, 명확한 패턴
  - MEDIUM : 문맥 속 포함, 형식 변형
  - HARD   : 난독화, 비정형, 오탐 유사 패턴

각 테스트 케이스 구조:
  - id:            테스트 케이스 고유 ID
  - category:      PII 카테고리
  - difficulty:    난이도 (EASY / MEDIUM / HARD)
  - intent:        이 테스트 케이스로 검증하고자 하는 것
  - document_text: 실제 문서 페이지 내용 (1페이지 분량)
  - expected_pii:  검출되어야 하는 PII 목록 [{type, value}]
  - false_positive_note: (선택) 오탐지 주의사항
"""

TEST_CASES_PART2 = [

    # =========================================================================
    # 카테고리 3: 주민등록번호 (Resident Registration Numbers) - TC023 ~ TC032
    # =========================================================================

    {
        "id": "TC023",
        "category": "주민등록번호",
        "difficulty": "EASY",
        "intent": "표준 형식(YYMMDD-NNNNNNN) 하이픈 포함 주민등록번호가 정확히 검출되는지 확인",
        "document_text": """
건강보험 자격 확인서

성명: 김영호
주민등록번호: 850315-1234567
자격 종류: 직장가입자
사업장명: 주식회사 한국테크
자격 취득일: 2010년 03월 01일

위 사항이 사실임을 확인합니다.

2024년 4월 15일
국민건강보험공단 이사장
""",
        "expected_pii": [
            {"type": "주민등록번호", "value": "850315-1234567"},
            {"type": "이름", "value": "김영호"},
        ],
    },

    {
        "id": "TC024",
        "category": "주민등록번호",
        "difficulty": "EASY",
        "intent": "하이픈 없는 13자리 연속 숫자 형태의 주민등록번호가 검출되는지 확인",
        "document_text": """
온라인 본인인증 로그 (내부 감사용)

일시: 2024-04-20 14:32:07
인증 방식: 휴대폰 본인인증
입력 주민등록번호: 9011231048271
인증 결과: 성공
인증 요청 IP: 192.168.1.55
서비스: 신규 회원가입

일시: 2024-04-20 14:35:22
인증 방식: 휴대폰 본인인증
입력 주민등록번호: 8807152135894
인증 결과: 성공
인증 요청 IP: 10.0.0.12
서비스: 비밀번호 재설정
""",
        "expected_pii": [
            {"type": "주민등록번호", "value": "9011231048271"},
            {"type": "주민등록번호", "value": "8807152135894"},
        ],
    },

    {
        "id": "TC025",
        "category": "주민등록번호",
        "difficulty": "MEDIUM",
        "intent": "서술형 문장 속에 자연스럽게 포함된 주민등록번호를 문맥에서 정확히 추출하는지 확인",
        "document_text": """
내부 감사 보고서 (개인정보 유출 사건)

2024년 3월 28일, CS팀 상담원 A가 고객 상담 중 개인정보 처리 절차를 위반한
사실이 확인되었습니다.

해당 상담원은 고객 문의 응대 과정에서 고객의 주민등록번호 780923-2456789를
메모장에 기록한 후 삭제하지 않았으며, 이 메모장 파일이 공유 폴더에 3일간
노출된 것으로 파악되었습니다.

추가 조사 결과, 동일 파일에 또 다른 고객의 주민등록번호인
861107-1987654도 함께 기록되어 있었습니다.

해당 상담원에 대한 징계 절차를 진행하며, 유출된 고객에게는 개별 통지할
예정입니다.

감사팀장 보고
""",
        "expected_pii": [
            {"type": "주민등록번호", "value": "780923-2456789"},
            {"type": "주민등록번호", "value": "861107-1987654"},
        ],
    },

    {
        "id": "TC026",
        "category": "주민등록번호",
        "difficulty": "MEDIUM",
        "intent": "뒷자리가 마스킹 처리된 주민등록번호(850315-1******)도 PII로 인식하는지 확인",
        "document_text": """
개인정보 수집 동의서

본인은 아래 개인정보의 수집 및 이용에 동의합니다.

수집 항목:
  - 성명: 박지현
  - 주민등록번호: 920418-2******
  - 연락처: 010-****-5678

수집 목적: 보험 계약 체결 및 이행
보유 기간: 계약 종료 후 5년

동의 거부 시 보험 계약이 불가할 수 있습니다.

본인은 위 내용을 충분히 이해하였으며 이에 동의합니다.

동의자: 박지현
동의일: 2024년 5월 1일

서명: _______________
""",
        "expected_pii": [
            {"type": "주민등록번호(마스킹)", "value": "920418-2******"},
            {"type": "이름", "value": "박지현"},
        ],
    },

    {
        "id": "TC027",
        "category": "주민등록번호",
        "difficulty": "HARD",
        "intent": "OCR 스캔 결과로 공백이나 특수문자가 삽입된 주민등록번호를 검출할 수 있는지 확인",
        "document_text": """
[OCR 스캔 결과 - 주민등록증 앞면]

대 한 민 국
주민등록증

성   명: 정 우 진
주민등록번호: 88 07 15 - 1 2 3 4 5 6 7

주   소: 서울특별시 관악구 관악로 1
         서울대학교 기숙사 301호

2006. 05. 20. 발급
서울특별시 관악구청장

[OCR 스캔 결과 - 주민등록증 뒷면]

주민등록번호: 8 8 0 7 1 5-1 2 3 4 5 6 7

혈액형 :  A  Rh+
발급기관: 서울특별시 관악구청
""",
        "expected_pii": [
            {"type": "주민등록번호", "value": "880715-1234567"},
            {"type": "이름", "value": "정우진"},
            {"type": "주소", "value": "서울특별시 관악구 관악로 1 서울대학교 기숙사 301호"},
        ],
        "false_positive_note": "OCR로 인해 주민번호에 공백이 삽입되었지만 '88 07 15 - 1 2 3 4 5 6 7'과 '8 8 0 7 1 5-1 2 3 4 5 6 7' 모두 동일 주민번호 880715-1234567로 인식해야 함",
    },

    {
        "id": "TC028",
        "category": "주민등록번호",
        "difficulty": "HARD",
        "intent": "주민등록번호와 유사한 13자리 숫자열(주문번호, 송장번호 등)이 주민번호로 오탐되지 않는지 확인",
        "document_text": """
물류 배송 현황 보고서

일자: 2024년 4월 22일

금일 처리 건수: 1,247건

주요 배송 건:
  1. 주문번호: 240422-1000234 / 송장번호: 951023-3847561 / 상태: 배송완료
  2. 주문번호: 240422-1000235 / 송장번호: 880715-6123487 / 상태: 배송중
  3. 주문번호: 240422-1000236 / 송장번호: 770304-4921083 / 상태: 집하

제품 시리얼: 831225-9100028
바코드 번호: 8801234-567890
관리 코드: 920101-0000001

전체 처리율: 98.3% (목표 대비 +1.3%p)
지연 건수: 21건 (전일 대비 -5건)
""",
        "expected_pii": [],
        "false_positive_note": "주문번호(240422-1000234), 송장번호(951023-3847561 등), 시리얼번호, 바코드번호, 관리코드는 모두 주민등록번호와 형식이 유사하지만 PII가 아님. 문맥(주문번호/송장번호 레이블)으로 구분해야 함",
    },

    {
        "id": "TC029",
        "category": "주민등록번호",
        "difficulty": "MEDIUM",
        "intent": "외국인등록번호(뒷자리 첫숫자 5~8)를 주민등록번호와 구분하여 검출하는지 확인",
        "document_text": """
외국인 근로자 등록 대장

No. | 성명           | 국적   | 외국인등록번호      | 비자유형 | 등록일
----|---------------|--------|-------------------|---------|----------
1   | Nguyen Van Duc | 베트남  | 850612-5123456    | E-9     | 2023.03.15
2   | Zhang Wei      | 중국   | 910830-6234567    | E-7     | 2023.05.20
3   | Tanaka Yuki    | 일본   | 880103-7345678    | E-2     | 2022.11.01

참고사항:
- 외국인등록번호 뒷자리 첫 자리가 5(남)또는 6(여)이면 한국 내 출생 외국인
- 7(남) 또는 8(여)이면 외국 출생 외국인
- 고용허가서 유효기간 확인 필수

인사관리팀
""",
        "expected_pii": [
            {"type": "외국인등록번호", "value": "850612-5123456"},
            {"type": "외국인등록번호", "value": "910830-6234567"},
            {"type": "외국인등록번호", "value": "880103-7345678"},
            {"type": "이름", "value": "Nguyen Van Duc"},
            {"type": "이름", "value": "Zhang Wei"},
            {"type": "이름", "value": "Tanaka Yuki"},
        ],
    },

    {
        "id": "TC030",
        "category": "주민등록번호",
        "difficulty": "HARD",
        "intent": "주민등록번호 앞 6자리(생년월일)만 노출된 경우에도 PII로 인식할 수 있는지 확인",
        "document_text": """
보험 사고 접수 내역

접수일시: 2024-04-25 09:15
접수번호: CLM-2024-04-0892

피보험자 정보:
  성명: 한수정
  생년월일: 870214 (주민등록번호 앞자리)
  연락처: 010-XXXX-XXXX

사고 내용:
  일시: 2024년 4월 23일 오후 3시경
  장소: 서울시 마포구 서교동 일대
  유형: 교통사고 (차대차)
  상해 부위: 경추 염좌

병원 진단서상 환자 생년월일(870214)과 일치 여부를 확인해 주시기 바랍니다.
보험금 지급 심사를 위해 추가 서류가 필요할 수 있습니다.

접수 담당: 사고접수팀
""",
        "expected_pii": [
            {"type": "주민등록번호(앞자리)", "value": "870214"},
            {"type": "이름", "value": "한수정"},
        ],
        "false_positive_note": "870214는 주민등록번호 앞 6자리(생년월일)로, 단독으로도 다른 정보와 결합 시 개인 식별이 가능하므로 PII로 간주. 단, 일반적인 날짜(2024-04-23)와 혼동하지 않아야 함",
    },

    {
        "id": "TC031",
        "category": "주민등록번호",
        "difficulty": "EASY",
        "intent": "여러 주민등록번호가 목록 형태로 나열된 경우 모두 정확히 검출되는지 확인",
        "document_text": """
단체보험 가입자 명단

보험 상품명: 행복한 가족 종합보험
계약번호: GRP-2024-00158
계약자: 주식회사 대한건설

피보험자 목록:
No. | 성명     | 주민등록번호      | 관계
----|---------|-----------------|------
1   | 이동건   | 760315-1234567  | 본인
2   | 김미숙   | 790822-2345678  | 배우자
3   | 이서준   | 050410-3456789  | 자녀
4   | 이하은   | 071225-4567890  | 자녀
5   | 이동건   | 760315-1234567  | 본인 (중복확인)

총 피보험자 수: 4명 (중복 제외)
보험료 월납: 125,000원

2024년 5월 1일
대한생명보험주식회사
""",
        "expected_pii": [
            {"type": "주민등록번호", "value": "760315-1234567"},
            {"type": "주민등록번호", "value": "790822-2345678"},
            {"type": "주민등록번호", "value": "050410-3456789"},
            {"type": "주민등록번호", "value": "071225-4567890"},
            {"type": "이름", "value": "이동건"},
            {"type": "이름", "value": "김미숙"},
            {"type": "이름", "value": "이서준"},
            {"type": "이름", "value": "이하은"},
        ],
    },

    {
        "id": "TC032",
        "category": "주민등록번호",
        "difficulty": "HARD",
        "intent": "OCR 인식 오류로 O/0, l/1 등이 혼동된 주민등록번호를 검출할 수 있는지 확인",
        "document_text": """
[OCR 스캔 문서 - 보험청구서 원본]

보험금 청구서

청구인 정보:
  성명: 최영수
  주민등록번호: 85O315-l234567
  (참고: 위 OCR 인식 결과 검토 필요)

  연락처: O1O-9876-543Z
  주소: 서울시 강남구 역삼동 12-3

청구 내용:
  사고일: 2O24년 O4월 1O일
  청구금액: 1,5OO,OOO원

[스캔 품질 노트]
- 숫자 '0'과 영문 'O' 혼동 가능성 있음
- 숫자 '1'과 영문 'l' 혼동 가능성 있음
- 숫자 '2'과 영문 'Z' 혼동 가능성 있음
- 원본 확인 필요한 항목: 주민등록번호, 연락처
""",
        "expected_pii": [
            {"type": "주민등록번호", "value": "85O315-l234567"},
            {"type": "이름", "value": "최영수"},
        ],
        "false_positive_note": "OCR 오류로 인해 '850315-1234567'이 '85O315-l234567'로 인식됨. 숫자 0이 영문 O로, 숫자 1이 소문자 l로 치환된 패턴을 주민번호로 인식해야 함",
    },

    # =========================================================================
    # 카테고리 4: 여권번호/운전면허번호 - TC033 ~ TC040
    # =========================================================================

    {
        "id": "TC033",
        "category": "여권번호",
        "difficulty": "EASY",
        "intent": "한국 여권번호(M+8자리) 표준 형식이 정확히 검출되는지 확인",
        "document_text": """
여권 정보 확인서

성명(한글): 정민호
성명(영문): JEONG MINHO
여권번호: M12345678
발급일: 2022년 08월 15일
만료일: 2032년 08월 14일
발급기관: 외교부
여권종류: 일반여권 (PM)

위 정보가 정확한지 확인하시고, 오류가 있을 경우
가까운 여권 사무대행기관에 방문하여 정정 신청해 주시기 바랍니다.

외교부
""",
        "expected_pii": [
            {"type": "여권번호", "value": "M12345678"},
            {"type": "이름", "value": "정민호"},
            {"type": "이름", "value": "JEONG MINHO"},
        ],
    },

    {
        "id": "TC034",
        "category": "운전면허번호",
        "difficulty": "MEDIUM",
        "intent": "한국 운전면허번호(NN-NN-NNNNNN-NN) 형식이 정확히 검출되는지 확인",
        "document_text": """
자동차 보험 가입 확인서

계약 정보:
  보험 상품: 자동차 종합보험
  계약번호: AUTO-2024-56789
  보험기간: 2024.05.01 ~ 2025.04.30

운전자 정보:
  성명: 이승민
  생년월일: 1988년 07월 22일
  운전면허번호: 11-22-345678-90
  면허 종류: 1종 보통
  면허 취득일: 2008년 03월 15일
  적성검사 유효기간: 2028년 07월 21일

차량 정보:
  차량번호: 123가 4567
  차종: 현대 쏘나타 DN8
  연식: 2023년

한국손해보험주식회사
""",
        "expected_pii": [
            {"type": "운전면허번호", "value": "11-22-345678-90"},
            {"type": "이름", "value": "이승민"},
        ],
    },

    {
        "id": "TC035",
        "category": "여권번호",
        "difficulty": "MEDIUM",
        "intent": "서술형 문장 속에 포함된 여권번호를 문맥에서 정확히 추출하는지 확인",
        "document_text": """
출입국 관련 민원 상담 기록

상담일시: 2024-05-10 11:20
상담유형: 전화상담

고객 문의 내용:
김하진 고객이 여권 분실 신고를 위해 전화하였습니다. 분실된 여권번호는
M87654321이며, 2020년 6월에 발급받은 것으로 확인됩니다. 고객은 다음 주
출국 예정이라 긴급 여권 발급을 요청하였습니다.

이전에 사용하던 구 여권번호 RP5432109도 함께 말소 처리가 필요한지
문의하였으나, 구 여권은 이미 만료되어 별도 처리 불필요합니다.

상담원 조치사항:
  - 여권 분실 신고 접수 완료
  - 긴급여권 발급 안내 (외교부 여권과)

상담원: 이정아
""",
        "expected_pii": [
            {"type": "여권번호", "value": "M87654321"},
            {"type": "여권번호", "value": "RP5432109"},
            {"type": "이름", "value": "김하진"},
            {"type": "이름", "value": "이정아"},
        ],
    },

    {
        "id": "TC036",
        "category": "여권번호",
        "difficulty": "HARD",
        "intent": "다양한 외국 여권번호 형식(미국/일본/독일 등)을 인식할 수 있는지 확인",
        "document_text": """
국제학술대회 참가자 여권 정보 취합 (비자 발급용)

대회명: 2024 International AI Conference
장소: 서울 COEX 컨벤션센터
기간: 2024.09.15~09.18

참가자 여권 정보:
1. 이름: James Robert Wilson (미국)
   여권번호: 567890123
   만료일: 2028-03-20
   비고: 미국 여권 9자리 숫자

2. 이름: Yuki Tanaka (일본)
   여권번호: TK1234567
   만료일: 2029-11-05
   비고: 일본 여권 영문2자리+숫자7자리

3. 이름: Hans Mueller (독일)
   여권번호: C4F7HJ2K1
   만료일: 2030-01-15
   비고: 독일 여권 영숫자 혼합 9자리

4. 이름: Marie Dupont (프랑스)
   여권번호: 22AB12345
   만료일: 2027-08-30
   비고: 프랑스 여권

담당: 국제협력팀 오수빈
""",
        "expected_pii": [
            {"type": "여권번호", "value": "567890123"},
            {"type": "여권번호", "value": "TK1234567"},
            {"type": "여권번호", "value": "C4F7HJ2K1"},
            {"type": "여권번호", "value": "22AB12345"},
            {"type": "이름", "value": "James Robert Wilson"},
            {"type": "이름", "value": "Yuki Tanaka"},
            {"type": "이름", "value": "Hans Mueller"},
            {"type": "이름", "value": "Marie Dupont"},
            {"type": "이름", "value": "오수빈"},
        ],
    },

    {
        "id": "TC037",
        "category": "여권번호",
        "difficulty": "EASY",
        "intent": "여권번호와 발급일자가 함께 기재된 경우 각각 정확히 검출되는지 확인",
        "document_text": """
비자 신청서 (요약)

신청인 정보:
  성명: 박소연
  성별: 여
  생년월일: 1992년 11월 08일

여권 정보:
  여권번호: M98765432
  발급일: 2023년 01월 10일
  만료일: 2033년 01월 09일
  발급지: 서울

비자 신청 정보:
  비자 종류: 관광비자 (B-2)
  체류 예정 기간: 2024.06.01 ~ 2024.06.15
  방문 목적: 관광
  체류 예정지: 도쿄, 오사카

이전 여권 정보:
  이전 여권번호: M55443322
  발급일: 2013년 05월 20일
  만료일: 2023년 05월 19일

주일본대한민국대사관
""",
        "expected_pii": [
            {"type": "여권번호", "value": "M98765432"},
            {"type": "여권번호", "value": "M55443322"},
            {"type": "이름", "value": "박소연"},
        ],
    },

    {
        "id": "TC038",
        "category": "운전면허번호",
        "difficulty": "HARD",
        "intent": "운전면허번호와 유사한 형식의 장비 시리얼코드/제품코드를 구분하는지 확인 (false positive)",
        "document_text": """
장비 관리 대장

관리부서: IT인프라팀
최종 점검일: 2024-05-15

장비 목록:
  1. 서버 랙 A-01
     시리얼: 12-34-567890-12
     모델: Dell PowerEdge R750
     상태: 정상

  2. 네트워크 스위치 N-03
     시리얼: 21-43-876543-21
     모델: Cisco Catalyst 9300
     상태: 정상

  3. UPS 장비 U-02
     시리얼: 33-11-223344-55
     모델: APC Smart-UPS 3000
     상태: 배터리 교체 예정

  4. 방화벽 장비 F-01
     제품코드: 44-55-667788-99
     모델: Palo Alto PA-3260
     상태: 펌웨어 업데이트 필요

참고: 시리얼 형식은 AA-BB-CCCCCC-DD (영역코드-제조코드-일련번호-검증코드)
""",
        "expected_pii": [],
        "false_positive_note": "장비 시리얼번호(12-34-567890-12 등)는 운전면허번호(NN-NN-NNNNNN-NN)와 동일한 형식이지만 PII가 아님. '시리얼', '제품코드' 등의 레이블과 장비 관리 문맥으로 구분해야 함",
    },

    {
        "id": "TC039",
        "category": "여권번호",
        "difficulty": "MEDIUM",
        "intent": "국제학술대회 참가자 명단에서 다양한 국가의 여권번호가 혼재된 경우 모두 검출하는지 확인",
        "document_text": """
2024 글로벌 바이오 컨퍼런스 참가자 등록 현황

등록번호 | 성명              | 국적    | 여권번호       | 등록비 납부
---------|------------------|---------|--------------|----------
REG-001  | 김태호            | 한국    | M11223344    | 완료
REG-002  | Sarah Johnson     | 미국    | 432198765    | 완료
REG-003  | Liu Xiaoming      | 중국    | E12345678    | 완료
REG-004  | Akira Suzuki      | 일본    | TZ5678901    | 미납
REG-005  | Chen Wei-Lin      | 대만    | 301234567    | 완료

총 등록 인원: 5명
등록비 미납: 1명 (REG-004 독촉 필요)

컨퍼런스 사무국
""",
        "expected_pii": [
            {"type": "여권번호", "value": "M11223344"},
            {"type": "여권번호", "value": "432198765"},
            {"type": "여권번호", "value": "E12345678"},
            {"type": "여권번호", "value": "TZ5678901"},
            {"type": "여권번호", "value": "301234567"},
            {"type": "이름", "value": "김태호"},
            {"type": "이름", "value": "Sarah Johnson"},
            {"type": "이름", "value": "Liu Xiaoming"},
            {"type": "이름", "value": "Akira Suzuki"},
            {"type": "이름", "value": "Chen Wei-Lin"},
        ],
    },

    {
        "id": "TC040",
        "category": "운전면허번호",
        "difficulty": "HARD",
        "intent": "군번, 사번과 운전면허번호가 함께 등장할 때 각각을 정확히 구분하는지 확인",
        "document_text": """
예비군 훈련 대상자 확인서

소속 부대: 제00사단 동원지원단
훈련일자: 2024년 5월 20일~21일 (1박 2일)

대상자 정보:
  성명: 강현우
  군번: 19-70123456
  사번(현 직장): 2018-001234
  운전면허번호: 13-07-654321-58

보유 면허: 1종 대형, 1종 보통
군 특기: 수송 (차량운전)

훈련 참석 시 지참 서류:
  - 예비군 훈련 통지서
  - 신분증 (운전면허증 가능)
  - 군번: 19-70123456 확인용

비고: 사번 2018-001234는 회사 출결 확인용이며 부대에 제출 불필요.
""",
        "expected_pii": [
            {"type": "운전면허번호", "value": "13-07-654321-58"},
            {"type": "이름", "value": "강현우"},
        ],
        "false_positive_note": "군번(19-70123456)과 사번(2018-001234)은 운전면허번호와 유사한 숫자열이지만 별도의 식별코드임. '군번', '사번' 레이블과 형식 차이로 구분해야 함. 다만, 군번과 사번도 개인 식별 정보이므로 별도 카테고리로 검출할 수 있음",
    },

    # =========================================================================
    # 카테고리 5: 이메일 (Email) - TC041 ~ TC048
    # =========================================================================

    {
        "id": "TC041",
        "category": "이메일",
        "difficulty": "EASY",
        "intent": "표준 이메일 주소(user@domain.com)가 정확히 검출되는지 확인",
        "document_text": """
직원 연락처 카드

성명: 조민서
직위: 선임연구원
부서: AI연구소
내선번호: 2345

이메일: minso.cho@koreatech.co.kr
업무 연락처: 02-1234-5678

담당 업무:
  - 자연어 처리 모델 연구
  - LLM 파인튜닝 및 평가
  - 논문 리뷰 및 학회 참석

긴급 연락처: minso.personal@gmail.com (개인)
""",
        "expected_pii": [
            {"type": "이메일", "value": "minso.cho@koreatech.co.kr"},
            {"type": "이메일", "value": "minso.personal@gmail.com"},
            {"type": "이름", "value": "조민서"},
        ],
    },

    {
        "id": "TC042",
        "category": "이메일",
        "difficulty": "EASY",
        "intent": "여러 이메일이 목록으로 나열된 경우 모두 정확히 검출되는지 확인",
        "document_text": """
프로젝트 킥오프 미팅 안내

일시: 2024년 5월 25일 (월) 10:00~11:30
장소: 본사 7층 대회의실

참석자 및 연락처:
  - 프로젝트 매니저: pm_lee@company.com
  - 백엔드 개발: backend_kim@company.com
  - 프론트엔드 개발: frontend_park@company.com
  - QA 담당: qa_choi@company.com
  - 디자인 담당: design_jung@company.com
  - 외부 컨설턴트: advisor.wang@consulting-firm.net

회의 자료는 사전에 pm_lee@company.com으로 전달 부탁드립니다.
참석이 어려우신 분은 qa_choi@company.com으로 회신 바랍니다.

감사합니다.
""",
        "expected_pii": [
            {"type": "이메일", "value": "pm_lee@company.com"},
            {"type": "이메일", "value": "backend_kim@company.com"},
            {"type": "이메일", "value": "frontend_park@company.com"},
            {"type": "이메일", "value": "qa_choi@company.com"},
            {"type": "이메일", "value": "design_jung@company.com"},
            {"type": "이메일", "value": "advisor.wang@consulting-firm.net"},
        ],
    },

    {
        "id": "TC043",
        "category": "이메일",
        "difficulty": "MEDIUM",
        "intent": "문장 속에서 괄호, 쉼표 등으로 둘러싸인 이메일을 정확히 추출하는지 확인",
        "document_text": """
협력업체 담당자 변경 안내

안녕하세요, 주식회사 한빛솔루션입니다.

기존 담당자 변경으로 인해 아래와 같이 연락처가 변경됨을 알려드립니다.

- 기술지원 문의는 이전 담당자(old_tech@hanbit.kr) 대신
  새 담당자(new_tech@hanbit.kr)로 연락 바랍니다.

- 계약/정산 관련 문의: billing@hanbit.kr, 또는 직통 finance_team@hanbit.kr

- 긴급 장애 신고는 (emergency@hanbit.kr)로 즉시 연락 주시기 바랍니다.
  (24시간 모니터링, 담당: 시스템운영팀)

- 대표 메일 주소 [info@hanbit.kr]도 함께 참조(CC)에 넣어주세요.

변경일: 2024년 6월 1일부터
""",
        "expected_pii": [
            {"type": "이메일", "value": "old_tech@hanbit.kr"},
            {"type": "이메일", "value": "new_tech@hanbit.kr"},
            {"type": "이메일", "value": "billing@hanbit.kr"},
            {"type": "이메일", "value": "finance_team@hanbit.kr"},
            {"type": "이메일", "value": "emergency@hanbit.kr"},
            {"type": "이메일", "value": "info@hanbit.kr"},
        ],
    },

    {
        "id": "TC044",
        "category": "이메일",
        "difficulty": "MEDIUM",
        "intent": "서브도메인이 포함된 복잡한 도메인의 이메일 주소를 정확히 검출하는지 확인",
        "document_text": """
시스템 접근 권한 신청서

신청일: 2024-06-05
신청자: 박준형

접근 권한 요청 내역:
  1. 운영 서버 SSH 접근
     계정: jpark@infra.internal.company.co.kr
     용도: 서버 모니터링 및 장애 대응

  2. 개발 서버 접근
     계정: jpark@dev.staging.company.co.kr
     용도: 개발/테스트 환경 배포

  3. 클라우드 콘솔 접근
     계정: junhyung.park@cloud.aws.company.co.kr
     용도: AWS 리소스 관리

  4. 모니터링 대시보드
     알림 수신: alerts+jpark@monitoring.ops.company.co.kr
     용도: 장애 알림 수신

승인자: 정보보안팀장
""",
        "expected_pii": [
            {"type": "이메일", "value": "jpark@infra.internal.company.co.kr"},
            {"type": "이메일", "value": "jpark@dev.staging.company.co.kr"},
            {"type": "이메일", "value": "junhyung.park@cloud.aws.company.co.kr"},
            {"type": "이메일", "value": "alerts+jpark@monitoring.ops.company.co.kr"},
            {"type": "이름", "value": "박준형"},
        ],
    },

    {
        "id": "TC045",
        "category": "이메일",
        "difficulty": "HARD",
        "intent": "난독화/변형된 이메일([at], [dot], 골뱅이 등)을 PII로 인식할 수 있는지 확인",
        "document_text": """
온라인 커뮤니티 게시글 (스크래핑 결과)

제목: 중고 노트북 판매합니다

맥북 프로 16인치 2023년형 팝니다.
상태 A급, 애플케어+ 2025년까지.
가격: 200만원 (네고 가능)

연락처:
  - 카톡 ID: seller_macbook
  - 이메일: macbook.seller[at]gmail[dot]com
  - 또는 macbook.seller 골뱅이 gmail 닷 com 으로 메일 주세요
  - 보조 메일: sell_mac (at) naver . com

직거래 선호합니다.
사기꾼 아닙니다 ㅎㅎ 이메일 확인해보시면 됩니다.
참고로 mseller(a)daum.net 으로도 연락 가능합니다.
""",
        "expected_pii": [
            {"type": "이메일(난독화)", "value": "macbook.seller[at]gmail[dot]com"},
            {"type": "이메일(난독화)", "value": "macbook.seller 골뱅이 gmail 닷 com"},
            {"type": "이메일(난독화)", "value": "sell_mac (at) naver . com"},
            {"type": "이메일(난독화)", "value": "mseller(a)daum.net"},
        ],
    },

    {
        "id": "TC046",
        "category": "이메일",
        "difficulty": "HARD",
        "intent": "SNS 핸들(@company)과 이메일 주소를 정확히 구분하는지 확인 (false positive)",
        "document_text": """
마케팅 캠페인 보고서

캠페인명: 2024 여름 시즌 프로모션
기간: 2024.06.01 ~ 2024.06.30

SNS 채널별 성과:
  - 인스타그램 @koreabeauty_official: 팔로워 12.5만, 도달 45만
  - 트위터(X) @koreabeauty_kr: 팔로워 3.2만, 노출 22만
  - 유튜브 @KoreaBeautyTV: 구독자 8.7만, 조회수 120만

인플루언서 협업:
  - @beauty_queen_sso (인스타): 게시물 3건, 좋아요 평균 2,340
  - @daily_skincare (인스타): 게시물 2건, 좋아요 평균 1,890

문의사항은 marketing@koreabeauty.co.kr로 연락 바랍니다.
인플루언서 협업 문의: partnership@koreabeauty.co.kr

보고자: 마케팅팀
""",
        "expected_pii": [
            {"type": "이메일", "value": "marketing@koreabeauty.co.kr"},
            {"type": "이메일", "value": "partnership@koreabeauty.co.kr"},
        ],
        "false_positive_note": "SNS 핸들(@koreabeauty_official, @koreabeauty_kr, @KoreaBeautyTV, @beauty_queen_sso, @daily_skincare)은 이메일이 아닌 소셜미디어 계정명이므로 이메일로 검출되면 안 됨. @ 뒤에 도메인(.com, .kr 등)이 없는 것이 구분 포인트",
    },

    {
        "id": "TC047",
        "category": "이메일",
        "difficulty": "MEDIUM",
        "intent": "한글 문맥 속에 자연스럽게 삽입된 이메일을 정확히 추출하는지 확인",
        "document_text": """
교수님께 드리는 메일 (참고용 백업)

안녕하세요, 교수님. 컴퓨터공학과 석사과정 김유진입니다.

지난 주 말씀하신 논문 초안을 정리하여 professor.kim@university.ac.kr로
보내드렸는데 확인이 되셨을까요? 혹시 못 받으셨다면 개인 메일인
profkim.personal@hanmail.net으로 다시 보내드리겠습니다.

공동저자인 박사과정 이수현 선배(soohyun.lee@lab.university.ac.kr)도
리뷰 코멘트를 같이 보냈다고 하는데 확인 부탁드립니다.

저도 학교 메일(yujin.kim22@student.university.ac.kr)로 회신 주시면
바로 수정 반영하겠습니다.

감사합니다.
김유진 드림
""",
        "expected_pii": [
            {"type": "이메일", "value": "professor.kim@university.ac.kr"},
            {"type": "이메일", "value": "profkim.personal@hanmail.net"},
            {"type": "이메일", "value": "soohyun.lee@lab.university.ac.kr"},
            {"type": "이메일", "value": "yujin.kim22@student.university.ac.kr"},
            {"type": "이름", "value": "김유진"},
            {"type": "이름", "value": "이수현"},
        ],
    },

    {
        "id": "TC048",
        "category": "이메일",
        "difficulty": "HARD",
        "intent": "부분 마스킹된 이메일(h****@gmail.com)도 PII로 인식하는지 확인",
        "document_text": """
개인정보 유출 통지서

존경하는 회원님께,

당사 시스템 점검 중 일부 회원 정보가 외부에 노출된 사실을 확인하였습니다.
아래는 유출이 의심되는 회원 정보입니다.

유출 항목:
  1. 회원 ID: user_1234
     이메일: h****n@gmail.com (일부 마스킹 처리)

  2. 회원 ID: user_5678
     이메일: park***@naver.com

  3. 회원 ID: user_9012
     이메일: ****@daum.net (아이디 전체 마스킹)

  4. 회원 ID: user_3456
     이메일: lee.min**@company.co.kr

당사는 즉시 비밀번호 초기화 조치를 완료하였으며, 회원님께서도
비밀번호 변경을 권장드립니다.

문의: privacy@securecompany.co.kr
""",
        "expected_pii": [
            {"type": "이메일(마스킹)", "value": "h****n@gmail.com"},
            {"type": "이메일(마스킹)", "value": "park***@naver.com"},
            {"type": "이메일(마스킹)", "value": "****@daum.net"},
            {"type": "이메일(마스킹)", "value": "lee.min**@company.co.kr"},
            {"type": "이메일", "value": "privacy@securecompany.co.kr"},
        ],
    },

    # =========================================================================
    # 카테고리 6: IP 주소 (IP Addresses) - TC049 ~ TC056
    # =========================================================================

    {
        "id": "TC049",
        "category": "IP주소",
        "difficulty": "EASY",
        "intent": "표준 IPv4 주소(점으로 구분된 4개 옥텟)가 정확히 검출되는지 확인",
        "document_text": """
서버 구성 정보 문서

서버명: WEB-PROD-01
역할: 웹 애플리케이션 서버 (프로덕션)

네트워크 설정:
  공인 IP: 203.248.52.100
  사설 IP: 10.10.1.25
  서브넷 마스크: 255.255.255.0
  기본 게이트웨이: 10.10.1.1
  DNS 서버 1: 8.8.8.8
  DNS 서버 2: 8.8.4.4

OS: Ubuntu 22.04 LTS
CPU: 8 vCPU
메모리: 32GB
스토리지: 500GB SSD

관리 담당: 인프라운영팀
""",
        "expected_pii": [
            {"type": "IP주소", "value": "203.248.52.100"},
            {"type": "IP주소", "value": "10.10.1.25"},
            {"type": "IP주소", "value": "10.10.1.1"},
            {"type": "IP주소", "value": "8.8.8.8"},
            {"type": "IP주소", "value": "8.8.4.4"},
        ],
    },

    {
        "id": "TC050",
        "category": "IP주소",
        "difficulty": "EASY",
        "intent": "방화벽 ACL에 여러 IP가 나열된 경우 모두 정확히 검출되는지 확인",
        "document_text": """
방화벽 정책 변경 요청서

요청일: 2024-06-10
요청부서: 개발팀
요청자: 서진우

변경 내용: 아래 IP에 대해 TCP 443 포트 인바운드 허용 요청

허용 대상 IP 목록:
  1. 211.234.56.78   (본사 사무실)
  2. 121.167.89.101  (판교 R&D센터)
  3. 58.123.45.200   (부산 지사)
  4. 175.209.12.34   (협력사 A)
  5. 220.95.67.89    (협력사 B)

차단 대상 IP (보안 위협 탐지):
  6. 185.220.101.45  (Tor exit node)
  7. 91.234.56.78    (악성 스캐너)

적용 방화벽: FW-PROD-01, FW-PROD-02
적용 희망일: 2024-06-12

승인자: 정보보안팀장
""",
        "expected_pii": [
            {"type": "IP주소", "value": "211.234.56.78"},
            {"type": "IP주소", "value": "121.167.89.101"},
            {"type": "IP주소", "value": "58.123.45.200"},
            {"type": "IP주소", "value": "175.209.12.34"},
            {"type": "IP주소", "value": "220.95.67.89"},
            {"type": "IP주소", "value": "185.220.101.45"},
            {"type": "IP주소", "value": "91.234.56.78"},
            {"type": "이름", "value": "서진우"},
        ],
    },

    {
        "id": "TC051",
        "category": "IP주소",
        "difficulty": "MEDIUM",
        "intent": "서버 액세스 로그 속에 포함된 IP 주소를 정확히 추출하는지 확인",
        "document_text": """
[웹 서버 액세스 로그 발췌 - 비정상 접근 탐지 보고]

보고일시: 2024-06-15 09:00
분석기간: 2024-06-14 00:00 ~ 23:59
분석대상: WEB-PROD-01 Nginx 액세스 로그

비정상 접근 패턴 탐지 건:

[2024-06-14 03:22:15] 45.33.32.156 - - "GET /admin/login HTTP/1.1" 403 162 "-" "sqlmap/1.5"
[2024-06-14 03:22:16] 45.33.32.156 - - "POST /admin/login HTTP/1.1" 403 162 "-" "sqlmap/1.5"
[2024-06-14 05:10:33] 198.51.100.23 - - "GET /../../etc/passwd HTTP/1.1" 400 0 "-" "Mozilla/5.0"
[2024-06-14 12:45:01] 172.16.0.105 - - "GET /api/users?id=1 OR 1=1 HTTP/1.1" 200 5432 "-" "curl/7.68"
[2024-06-14 18:30:22] 203.0.113.50 - - "GET /wp-login.php HTTP/1.1" 404 0 "-" "WPScan v3.8"

분석 결과:
  - 45.33.32.156: SQL 인젝션 시도 (sqlmap 도구 사용)
  - 198.51.100.23: 디렉토리 트래버설 시도
  - 172.16.0.105: 내부 IP에서 SQL 인젝션 시도 (내부 조사 필요)
  - 203.0.113.50: WordPress 무차별 대입 스캔

조치 사항: 외부 IP 3건 방화벽 차단 완료, 내부 IP 1건 조사 중
""",
        "expected_pii": [
            {"type": "IP주소", "value": "45.33.32.156"},
            {"type": "IP주소", "value": "198.51.100.23"},
            {"type": "IP주소", "value": "172.16.0.105"},
            {"type": "IP주소", "value": "203.0.113.50"},
        ],
    },

    {
        "id": "TC052",
        "category": "IP주소",
        "difficulty": "MEDIUM",
        "intent": "IPv6 주소(풀 표기 및 축약형 포함)를 정확히 검출하는지 확인",
        "document_text": """
네트워크 인프라 IPv6 전환 보고서

작성일: 2024-06-20
작성자: 네트워크운영팀

1. 현재 IPv6 할당 현황

  웹 서버 (WEB-01):
    IPv6: 2001:0db8:85a3:0000:0000:8a2e:0370:7334

  API 서버 (API-01):
    IPv6: 2001:db8:85a3::8a2e:370:7334 (축약형)

  DB 서버 (DB-01):
    IPv6: fd00::1 (사설 IPv6, ULA)

  DNS 서버:
    IPv6: 2606:4700:4700::1111 (Cloudflare DNS)
    IPv6: 2001:4860:4860::8888 (Google DNS)

2. 전환 진행률: 60%

3. 이슈 사항:
  - 로드밸런서의 IPv6 지원 펌웨어 업데이트 필요
  - 일부 레거시 시스템 IPv6 미지원 (DB-02, LEGACY-01)

4. 다음 단계: 2024년 3분기 내 전환 완료 목표
""",
        "expected_pii": [
            {"type": "IP주소(IPv6)", "value": "2001:0db8:85a3:0000:0000:8a2e:0370:7334"},
            {"type": "IP주소(IPv6)", "value": "2001:db8:85a3::8a2e:370:7334"},
            {"type": "IP주소(IPv6)", "value": "fd00::1"},
            {"type": "IP주소(IPv6)", "value": "2606:4700:4700::1111"},
            {"type": "IP주소(IPv6)", "value": "2001:4860:4860::8888"},
        ],
    },

    {
        "id": "TC053",
        "category": "IP주소",
        "difficulty": "HARD",
        "intent": "사설 IP와 공인 IP를 구분하여 태깅할 수 있는지 확인. 사설 IP도 내부 인프라 노출 위험이 있으므로 PII로 취급",
        "document_text": """
보안 취약점 점검 보고서

점검일: 2024-06-25
점검 대상: 사내 네트워크 전체
점검 도구: Nessus Professional

[Critical] 내부 네트워크 구조 노출
  - 192.168.1.1 (내부 게이트웨이) 관리 페이지가 외부에서 접근 가능
  - 10.0.0.50 (내부 DNS) 존 전송(Zone Transfer) 허용됨
  - 172.31.0.100 (내부 DB 서버) 원격 접속 포트(3306) 외부 노출

[High] 공인 IP 서비스 취약점
  - 61.100.25.30 (웹 서버) Apache 버전 취약점 (CVE-2024-XXXX)
  - 211.45.67.89 (메일 서버) SMTP 릴레이 허용
  - 125.209.222.100 (VPN 게이트웨이) 구버전 OpenSSL 사용

[Medium] 기타
  - 192.168.10.200 (사내 프린터) SNMP community string 기본값 사용
  - 10.10.5.15 (개발 서버) SSH root 로그인 허용

조치 권고: Critical/High 항목은 72시간 이내 조치 필요
""",
        "expected_pii": [
            {"type": "IP주소(사설)", "value": "192.168.1.1"},
            {"type": "IP주소(사설)", "value": "10.0.0.50"},
            {"type": "IP주소(사설)", "value": "172.31.0.100"},
            {"type": "IP주소(공인)", "value": "61.100.25.30"},
            {"type": "IP주소(공인)", "value": "211.45.67.89"},
            {"type": "IP주소(공인)", "value": "125.209.222.100"},
            {"type": "IP주소(사설)", "value": "192.168.10.200"},
            {"type": "IP주소(사설)", "value": "10.10.5.15"},
        ],
    },

    {
        "id": "TC054",
        "category": "IP주소",
        "difficulty": "HARD",
        "intent": "IP 주소와 유사한 버전번호/빌드번호를 구분할 수 있는지 확인 (false positive)",
        "document_text": """
소프트웨어 릴리즈 노트

제품명: SmartOffice Suite
버전: 4.2.1.3892
빌드번호: 10.3.48.1024
릴리즈 일자: 2024-07-01

변경 이력:
  - v4.2.1.3892: 보안 패치 적용
  - v4.2.0.3500: 신규 기능 (대시보드 개편)
  - v4.1.9.3200: 버그 수정 (문서 편집기 충돌)
  - v3.12.0.2800: 이전 메이저 버전

시스템 요구사항:
  - OS: Windows 10.0.19045 이상
  - .NET Framework: 4.8.1.0
  - Java: 17.0.2.8

라이선스 서버: 10.20.30.40 (사내 전용)
업데이트 서버: update.smartoffice.com (203.100.50.25)

기술지원: support@smartoffice.com
""",
        "expected_pii": [
            {"type": "IP주소", "value": "10.20.30.40"},
            {"type": "IP주소", "value": "203.100.50.25"},
            {"type": "이메일", "value": "support@smartoffice.com"},
        ],
        "false_positive_note": "소프트웨어 버전(4.2.1.3892), 빌드번호(10.3.48.1024), OS 버전(10.0.19045), 프레임워크 버전(4.8.1.0, 17.0.2.8)은 IP 주소와 점(.)으로 구분된 숫자 형식이 유사하지만 IP가 아님. '버전', 'v', 빌드 문맥으로 구분해야 함. 단, '라이선스 서버: 10.20.30.40'과 '203.100.50.25'는 실제 IP 주소",
    },

    {
        "id": "TC055",
        "category": "IP주소",
        "difficulty": "MEDIUM",
        "intent": "CIDR 표기법(10.0.0.0/8)으로 된 IP 대역을 검출하는지 확인",
        "document_text": """
네트워크 세그먼트 설계 문서

작성일: 2024-07-05
작성자: 네트워크설계팀

1. 사내 네트워크 IP 대역 할당 계획

  본사 네트워크:
    - 사무실 유선: 10.10.0.0/16
    - 사무실 무선: 10.20.0.0/16
    - 게스트 Wi-Fi: 172.16.100.0/24

  데이터센터:
    - 프로덕션 서버: 10.100.0.0/16
    - 스테이징 서버: 10.200.0.0/16
    - DMZ: 192.168.50.0/24

  VPN:
    - 직원 VPN: 10.250.0.0/24
    - 협력사 VPN: 10.251.0.0/24

2. 라우팅 정책
  - 기본 게이트웨이: 10.10.0.1
  - 인터넷 게이트웨이: 61.100.25.1
  - 사설 대역(10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16)은 NAT 적용

3. 향후 계획: IPv6 듀얼스택 전환 (2025년 상반기)
""",
        "expected_pii": [
            {"type": "IP주소(CIDR)", "value": "10.10.0.0/16"},
            {"type": "IP주소(CIDR)", "value": "10.20.0.0/16"},
            {"type": "IP주소(CIDR)", "value": "172.16.100.0/24"},
            {"type": "IP주소(CIDR)", "value": "10.100.0.0/16"},
            {"type": "IP주소(CIDR)", "value": "10.200.0.0/16"},
            {"type": "IP주소(CIDR)", "value": "192.168.50.0/24"},
            {"type": "IP주소(CIDR)", "value": "10.250.0.0/24"},
            {"type": "IP주소(CIDR)", "value": "10.251.0.0/24"},
            {"type": "IP주소", "value": "10.10.0.1"},
            {"type": "IP주소", "value": "61.100.25.1"},
            {"type": "IP주소(CIDR)", "value": "10.0.0.0/8"},
            {"type": "IP주소(CIDR)", "value": "172.16.0.0/12"},
            {"type": "IP주소(CIDR)", "value": "192.168.0.0/16"},
        ],
    },

    {
        "id": "TC056",
        "category": "IP주소",
        "difficulty": "HARD",
        "intent": "IP:포트 조합(192.168.1.1:8080)에서 IP 주소와 포트를 정확히 파싱하는지 확인",
        "document_text": """
마이크로서비스 아키텍처 구성 현황

프로젝트: 스마트 주문 플랫폼
환경: 스테이징 (STG)
최종 업데이트: 2024-07-10

서비스 엔드포인트 목록:

  API Gateway:
    - 외부 접점: https://211.45.67.89:443
    - 내부 접점: http://10.100.1.10:8080

  주문 서비스 (Order Service):
    - http://10.100.1.20:8081
    - gRPC: 10.100.1.20:9090

  결제 서비스 (Payment Service):
    - http://10.100.1.30:8082
    - 외부 PG 연동: https://pg-api.payment.co.kr (125.200.50.60:443)

  재고 서비스 (Inventory Service):
    - http://10.100.1.40:8083

  알림 서비스 (Notification Service):
    - http://10.100.1.50:8084
    - SMTP 릴레이: 10.100.2.10:587

  데이터베이스:
    - MongoDB: 10.100.3.10:27017
    - Redis: 10.100.3.20:6379
    - Elasticsearch: 10.100.3.30:9200

  모니터링:
    - Grafana: http://10.100.5.10:3000
    - Prometheus: http://10.100.5.20:9090

담당: 플랫폼개발팀
""",
        "expected_pii": [
            {"type": "IP주소:포트", "value": "211.45.67.89:443"},
            {"type": "IP주소:포트", "value": "10.100.1.10:8080"},
            {"type": "IP주소:포트", "value": "10.100.1.20:8081"},
            {"type": "IP주소:포트", "value": "10.100.1.20:9090"},
            {"type": "IP주소:포트", "value": "10.100.1.30:8082"},
            {"type": "IP주소:포트", "value": "125.200.50.60:443"},
            {"type": "IP주소:포트", "value": "10.100.1.40:8083"},
            {"type": "IP주소:포트", "value": "10.100.1.50:8084"},
            {"type": "IP주소:포트", "value": "10.100.2.10:587"},
            {"type": "IP주소:포트", "value": "10.100.3.10:27017"},
            {"type": "IP주소:포트", "value": "10.100.3.20:6379"},
            {"type": "IP주소:포트", "value": "10.100.3.30:9200"},
            {"type": "IP주소:포트", "value": "10.100.5.10:3000"},
            {"type": "IP주소:포트", "value": "10.100.5.20:9090"},
        ],
    },
]
