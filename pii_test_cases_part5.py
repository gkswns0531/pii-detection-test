"""
PII 검출 테스트 케이스 Part 5 (TC088~TC100)
Categories: False Positive (오탐지 검증), 난독화/변형 (Obfuscation)

이 파일은 PII 검출기의 오탐지 방지 성능과 난독화된 PII 검출 성능을 검증하기 위한
테스트 케이스를 포함합니다.

카테고리 10: False Positive (오탐지 검증) - TC088~TC097
  - PII처럼 보이지만 실제로는 개인정보가 아닌 패턴들
  - 기업 정보, 기술 수치, 공인 정보, 허구 데이터 등

카테고리 11: 난독화/변형 (Obfuscation) - TC098~TC100
  - 의도적으로 변형된 PII (공백 삽입, 한글 변환 등)
  - OCR 인식 오류로 변형된 PII
  - 유니코드 전각/반각 혼합 변형
"""

TEST_CASES_PART5 = [

    # =========================================================================
    # 카테고리 10: False Positive (오탐지 검증) - TC088 ~ TC097
    # =========================================================================

    {
        "id": "TC088",
        "category": "False Positive",
        "difficulty": "EASY",
        "intent": "순수 업무 보고서에서 PII가 전혀 없음을 정확히 판별하는지 확인. 숫자와 퍼센트 등이 많지만 개인정보는 포함되지 않은 문서",
        "document_text": """
2024년 3분기 매출 현황 보고서

1. 매출 요약
  - 총매출액: 1,284억 원 (전년 동기 대비 12.5% 증가)
  - 영업이익: 203억 원 (영업이익률 15.8%)
  - 순이익: 147억 원

2. 사업부별 매출 현황
  - B2B 솔루션: 521억 원 (40.6%)
  - B2C 플랫폼: 438억 원 (34.1%)
  - 해외 사업: 325억 원 (25.3%)

3. 시장 분석
  국내 IT 서비스 시장은 2024년 기준 약 58조 원 규모로 추정되며,
  전년 대비 8.2% 성장하였습니다. 당사의 시장 점유율은 약 2.2%로
  업계 7위 수준입니다.

4. 4분기 전망
  하반기 대형 프로젝트 3건(총 수주액 약 180억 원)의 매출 인식이 예정되어 있어
  연간 매출 목표 5,000억 원 달성이 가능할 것으로 예상됩니다.
  특히 공공부문 디지털 전환 과제 수주가 증가 추세이며,
  신규 클라우드 서비스의 월간 활성 사용자(MAU)가 15만 명을 돌파하였습니다.

경영기획실
""",
        "expected_pii": [],
        "false_positive_note": "매출액, 비율, 시장 규모 등 숫자가 다수 포함되어 있으나 모두 기업 재무 수치이므로 PII가 아님",
    },

    {
        "id": "TC089",
        "category": "False Positive",
        "difficulty": "MEDIUM",
        "intent": "기술 문서의 숫자 패턴(포트번호, 메모리 용량, IP 대역 등)이 전화번호나 개인 IP로 오인되지 않는지 확인",
        "document_text": """
서버 인프라 사양 보고서

1. 웹 서버 (WEB-01 ~ WEB-04)
  - CPU: Intel Xeon Gold 6348 (28코어, 2.60GHz) x 2
  - RAM: 16384MB (16GB DDR4 ECC) x 8 = 131072MB
  - OS: Rocky Linux 8.9
  - 서비스 포트: 80(HTTP), 443(HTTPS), 8080(관리콘솔), 8443(내부API)
  - 로드밸런서 VIP: 10.0.0.0/24 대역

2. DB 서버 (DB-01, DB-02)
  - MySQL 8.0.36, 포트 3306
  - PostgreSQL 16.2, 포트 5432
  - 최대 커넥션 수: 1000
  - 스토리지: 2048GB SSD RAID-10

3. 캐시 서버
  - Redis 7.2.4, 포트 6379
  - Memcached 1.6.22, 포트 11211
  - 최대 메모리: 65536MB

4. 네트워크 구성
  - 내부 대역: 172.16.0.0/16
  - DMZ 대역: 192.168.100.0/24
  - 방화벽 정책 수: 342개
  - 대역폭: 10Gbps (업링크), 1Gbps (서버 NIC)
  - MTU: 9000 (점보프레임)

5. 모니터링
  - Prometheus 수집 간격: 15초
  - Grafana 대시보드: 27개
  - 알림 임계치: CPU 85%, 메모리 90%, 디스크 95%
""",
        "expected_pii": [],
        "false_positive_note": "포트번호(8080, 3306, 5432 등), 네트워크 대역(172.16.0.0/16, 192.168.100.0/24), 메모리 수치(16384MB) 등이 전화번호나 개인 IP 주소로 오탐되지 않아야 함. 특히 CIDR 표기의 IP는 네트워크 대역이지 개인 IP가 아님",
    },

    {
        "id": "TC090",
        "category": "False Positive",
        "difficulty": "MEDIUM",
        "intent": "회사명, 부서명, 지명+시설명이 사람 이름으로 오인되지 않는지 확인. 한국어 고유명사 구분 능력 검증",
        "document_text": """
2024년 제조업 동향 분석 보고서

1. 주요 기업별 투자 현황
  한국전력은 올해 신재생에너지 분야에 3조 2천억 원을 투자할 계획이며,
  삼성전자는 평택캠퍼스에 반도체 생산라인을 추가 증설 중입니다.
  현대자동차 울산공장은 전기차 전용 라인을 가동하기 시작했으며,
  LG에너지솔루션 오창공장의 배터리 생산 능력은 월 50GWh에 달합니다.

2. 주요 산업단지 현황
  - 김포공장 지대: 가동률 87.3%
  - 이천연구소 클러스터: 입주 기업 142개사
  - 구미국가산업단지: 전자부품 수출액 전년 대비 15% 증가
  - 창원국가산업단지: 기계산업 생산액 28조 원

3. 정부 정책 동향
  산업통상자원부는 '스마트 제조혁신 2.0' 정책을 발표하였으며,
  중소벤처기업부와 공동으로 중소기업 스마트공장 보급 사업을 추진합니다.
  한국산업기술평가관리원(KEIT)이 평가 기관으로 참여합니다.

4. 전망
  대한상공회의소 조사에 따르면, 제조업체의 72%가 2024년 하반기
  설비 투자를 확대할 계획이라고 응답하였습니다.
""",
        "expected_pii": [],
        "false_positive_note": "한국전력, 삼성전자, 현대자동차, LG에너지솔루션 등은 기업명이며 사람 이름이 아님. 김포공장, 이천연구소 등에서 '김포', '이천'은 지명이며 성씨가 아님. 산업통상자원부, 중소벤처기업부 등은 정부 부처명",
    },

    {
        "id": "TC091",
        "category": "False Positive",
        "difficulty": "HARD",
        "intent": "법률 용어, 법원명, 랜드마크 지명이 주소나 이름으로 오인되지 않는지 확인. 법원명은 지역명이 포함되어 있어 주소로 혼동 가능",
        "document_text": """
법률 검토 의견서

1. 사건 개요
  본 건은 서울중앙지방법원 2024가합12345호 사건에 관한 것으로,
  대전고등법원에서 항소심이 진행 중입니다. 원심인 대전지방법원 천안지원의
  판결에 대해 피고 측이 항소한 사안입니다.

2. 쟁점 분석
  대법원 2023다54321 판례에 따르면, 부동산 소재지가 서울특별시인 경우에도
  관할법원은 피고의 주소지를 기준으로 정함이 원칙입니다.
  다만, 수원지방법원 성남지원 관할 구역 내에서 발생한 사안에 대해서는
  예외적으로 사건 발생지 법원에 소를 제기할 수 있습니다.

3. 관련 장소
  분쟁 대상 부동산은 강남역 사거리에서 도보 10분 거리에 위치하며,
  종로3가 인근의 상업지구와 유사한 용도지역(일반상업지역)에 해당합니다.
  서울역 북부역세권 개발 사업 구역과도 인접해 있어
  향후 지가 변동 가능성이 있습니다.

4. 의견
  부산고등법원 판례(2022나98765)에서 확립된 기준에 따라
  본 건의 승소 가능성은 약 60~70%로 판단됩니다.
  인천지방법원에서의 가처분 신청도 병행 검토가 필요합니다.
""",
        "expected_pii": [],
        "false_positive_note": "서울중앙지방법원, 대전고등법원, 수원지방법원 성남지원 등은 법원명이며 주소가 아님. 강남역 사거리, 종로3가, 서울역 북부역세권 등은 랜드마크/지명이며 특정 개인의 주소가 아님. 사건번호(2024가합12345)는 법원 사건 관리번호이며 PII가 아님",
    },

    {
        "id": "TC092",
        "category": "False Positive",
        "difficulty": "HARD",
        "intent": "제품 코드/모델번호가 여권번호, 운전면허번호, 주민등록번호 등과 유사한 패턴을 가지지만 문맥상 PII가 아님을 구분하는지 확인",
        "document_text": """
재고 관리 대장 - 2024년 10월

[전자제품 입고 목록]

순번 | 제품코드        | 모델명                | 수량 | 단가(원)
-----|----------------|----------------------|------|----------
  1  | M12345678      | 스마트워치 Pro Max    |  500 | 389,000
  2  | M98765432      | 무선이어폰 AirX       |  300 | 159,000
  3  | S12-34-567890-12 | 태블릿 SlimPad 11   |  200 | 699,000
  4  | P850315-2K4R7  | 블루투스 스피커 BO-X   | 1000 |  79,000
  5  | KR-AB-123456-78 | 스마트밴드 FitTrack   |  800 |  49,000
  6  | 930101-PROD-V2 | USB-C 허브 MultiPort  |  600 |  35,000

[비고]
- 제품코드 M12345678은 해외 공급사의 글로벌 코드 체계(M + 8자리)를 따릅니다.
- S12-34-567890-12는 국내 유통 전용 코드(지역-카테고리-일련번호-버전)입니다.
- P850315-2K4R7은 생산일자(850315) 기반 코드이며, 주민등록번호가 아닙니다.
- 930101-PROD-V2의 앞 6자리는 제품 시리즈 코드이지 생년월일이 아닙니다.

총 입고 금액: 약 4억 8천만 원
창고 담당 부서: 물류관리팀
""",
        "expected_pii": [],
        "false_positive_note": "M12345678은 여권번호(M+8자리)와 동일 패턴이지만 제품코드임. S12-34-567890-12는 운전면허번호 패턴과 유사하지만 유통코드임. P850315-2K4R7과 930101-PROD-V2는 주민등록번호 앞자리와 유사하지만 생산/시리즈 코드임. 문맥(재고관리, 제품코드 레이블)으로 구분해야 함",
    },

    {
        "id": "TC093",
        "category": "False Positive",
        "difficulty": "MEDIUM",
        "intent": "기업 대표번호, 고객센터 번호, 팩스번호 등 공개된 법인 번호가 개인 전화번호로 오인되지 않는지 확인",
        "document_text": """
주요 거래처 연락처 목록 (공개 정보)

[금융기관]
  - 국민은행 고객센터: 1588-9999 / 1599-9999
  - 신한은행 고객센터: 1577-8000
  - 하나은행 대표번호: 1588-1111
  - 우리은행 상담전화: 1588-5000 / 1599-5000

[통신사]
  - SKT 고객센터: 080-011-6000 (무료)
  - KT 고객센터: 100 (단축번호) / 080-000-0100
  - LG U+ 고객센터: 1544-0010

[택배/물류]
  - CJ대한통운: 1588-1255 / FAX 02-2168-4399
  - 한진택배: 1588-0011 / FAX 02-728-5600
  - 롯데택배: 1588-2121 / FAX 02-2630-0098

[공공기관]
  - 국세청 세미래 콜센터: 126
  - 고용노동부 상담센터: 1350
  - 건강보험공단: 1577-1000

[참고사항]
  1588, 1577, 1599로 시작하는 번호는 기업 대표번호입니다.
  080으로 시작하는 번호는 수신자 부담 무료전화입니다.
  위 번호들은 모두 공개된 기업/기관 연락처이며 개인정보에 해당하지 않습니다.
""",
        "expected_pii": [],
        "false_positive_note": "1588-xxxx, 1577-xxxx, 1599-xxxx 등은 기업 대표번호이며 개인 전화번호가 아님. 080-xxx-xxxx는 수신자 부담 무료전화. FAX 번호도 기업 공개 팩스번호. 126, 1350 등은 공공기관 단축번호. 모두 공개 정보이므로 PII 처리 불필요",
    },

    {
        "id": "TC094",
        "category": "False Positive",
        "difficulty": "HARD",
        "intent": "학술 논문의 참고문헌에 등장하는 저자명이 PII로 처리되지 않아야 하는지 확인. 학술 저자명은 공개 정보",
        "document_text": """
한국어 자연어 처리 모델의 편향성 분석에 관한 연구

초록:
본 연구에서는 사전학습된 한국어 언어모델에 내재된 사회적 편향을 정량적으로
분석하였다. 기존 영어권 연구(Bolukbasi et al., 2016; Caliskan et al., 2017)의
방법론을 한국어에 맞게 변형하여 적용하였으며, KoBERT, KoGPT2, KoELECTRA
세 가지 모델을 대상으로 실험을 수행하였다.

[본문 일부]
Kim et al. (2023)은 한국어 감정 분석에서의 성별 편향을 보고한 바 있으며,
Park & Lee (2022)는 KoBERT의 직업 연관 편향을 Word Embedding Association
Test(WEAT)를 통해 검증하였다. 본 연구는 이를 확장하여 연령, 지역 편향까지
분석 범위를 넓혔다. 특히 Cho & Jung (2024)이 제안한 한국어 편향 측정
프레임워크(K-BIAS)를 활용하였으며, Song (2023)의 데이터 전처리 기법을
일부 채택하였다.

참고문헌:
[1] Bolukbasi, T., Chang, K. W., Zou, J., Salovey, V., & Kalai, A. (2016).
    Man is to computer programmer as woman is to homemaker? Debiasing word embeddings.
    Advances in Neural Information Processing Systems, 29.
[2] Caliskan, A., Bryson, J. J., & Narayanan, A. (2017). Semantics derived
    automatically from language corpora contain human-like biases. Science, 356(6334).
[3] Cho, H., & Jung, S. (2024). K-BIAS: A comprehensive framework for measuring
    social bias in Korean language models. Journal of Korean NLP, 12(3), 45-67.
[4] Kim, J., Park, Y., & Lee, M. (2023). Gender bias in Korean sentiment analysis.
    Proceedings of ACL 2023, 1234-1248.
[5] Park, S., & Lee, D. (2022). Occupational bias in KoBERT: A WEAT-based analysis.
    Korean Journal of AI Research, 8(2), 112-128.
[6] Song, Y. (2023). Preprocessing techniques for bias evaluation in Korean NLP.
    arXiv preprint arXiv:2310.12345.
""",
        "expected_pii": [],
        "false_positive_note": "학술 논문의 저자명(Kim et al., Park & Lee, Cho & Jung, Bolukbasi, Caliskan 등)은 학술적 공개 정보이며 PII 처리 대상이 아님. 참고문헌의 저자 성명도 동일하게 공개된 학술 정보. 다만, PII 정책에 따라 저자명을 PII로 분류하는 기관도 있을 수 있으므로 정책 의존적",
    },

    {
        "id": "TC095",
        "category": "False Positive",
        "difficulty": "HARD",
        "intent": "뉴스 기사에 등장하는 공인(대통령, 장관, CEO 등)의 이름과 공적 정보가 PII 처리 대상이 아님을 확인",
        "document_text": """
[경제면] 반도체 산업 지원 정책 발표

정부가 반도체 산업 경쟁력 강화를 위한 종합 대책을 발표했다.

이창용 한국은행 총재는 15일 기자회견에서 "반도체 산업에 대한 금융 지원을
대폭 확대하겠다"고 밝혔다. 이 총재는 "글로벌 공급망 재편 속에서 한국
반도체 산업의 위상을 강화하기 위해 총 20조 원 규모의 금융 지원 패키지를
마련했다"고 설명했다.

안덕근 산업통상자원부 장관은 같은 날 "반도체 특별법 시행령을 조기에
마련하여 세제 혜택과 규제 완화를 신속히 추진하겠다"고 밝혔다. 안 장관은
"미국, 일본, 유럽 등과의 반도체 협력 체계도 강화할 계획"이라고 덧붙였다.

업계에서는 환영하는 분위기다. 이재용 삼성전자 회장은 "정부의 적극적인
지원에 감사하며, 삼성전자도 향후 5년간 300조 원의 투자 계획을 차질 없이
이행하겠다"고 밝혔다. 최태원 SK그룹 회장도 "SK하이닉스의 HBM 기술력을
바탕으로 글로벌 AI 반도체 시장을 선도하겠다"고 강조했다.

한편, 야당은 "구체적인 재원 조달 방안이 불분명하다"며 비판적 입장을
보였다.

[이 기사는 2024년 10월 15일자 경제면 1면에 게재되었습니다]
""",
        "expected_pii": [],
        "false_positive_note": "이창용(한국은행 총재), 안덕근(산업부 장관), 이재용(삼성전자 회장), 최태원(SK그룹 회장) 등은 모두 공인이며, 뉴스 기사에서의 공적 활동을 보도한 것이므로 PII 처리 대상이 아님. 공인의 공적 발언과 직위는 공개 정보에 해당",
    },

    {
        "id": "TC096",
        "category": "False Positive",
        "difficulty": "MEDIUM",
        "intent": "프로그래밍 코드 내 IP 리터럴, 이메일 정규식, 테스트용 dummy 데이터가 실제 PII로 오인되지 않는지 확인",
        "document_text": """
# config.py - 서버 설정 파일

import re
from dataclasses import dataclass

# 네트워크 설정
BIND_HOST = "0.0.0.0"
BIND_PORT = 8080
LOCALHOST = "127.0.0.1"
DNS_SERVER = "8.8.8.8"
BACKUP_DNS = "8.8.4.4"

# 이메일 검증 정규식
EMAIL_PATTERN = re.compile(
    r'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$'
)

# 테스트용 더미 데이터 (실제 사용 금지)
TEST_FIXTURES = {
    "valid_email": "test@example.com",
    "invalid_email": "not-an-email",
    "admin_email": "admin@localhost",
    "noreply": "noreply@company.example.org",
}

@dataclass
class DatabaseConfig:
    host: str = "192.168.1.100"
    port: int = 5432
    name: str = "app_production"
    max_connections: int = 100

@dataclass
class RedisConfig:
    host: str = "10.0.1.50"
    port: int = 6379
    password: str = ""  # Set via environment variable

# 허용 IP 대역 (사내 네트워크)
ALLOWED_IP_RANGES = [
    "10.0.0.0/8",
    "172.16.0.0/12",
    "192.168.0.0/16",
]

# 로깅 설정
LOG_FORMAT = "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
HEALTH_CHECK_PATH = "/api/v1/health"
""",
        "expected_pii": [],
        "false_positive_note": "127.0.0.1은 로컬호스트, 8.8.8.8과 8.8.4.4는 Google DNS(공개 서비스), 192.168.1.100과 10.0.1.50은 내부 네트워크 설정값으로 실제 개인 IP가 아님. test@example.com, admin@localhost, noreply@company.example.org는 테스트/더미 이메일. 코드 컨텍스트에서의 IP/이메일은 설정값이지 개인정보가 아님",
    },

    {
        "id": "TC097",
        "category": "False Positive",
        "difficulty": "HARD",
        "intent": "소설/시나리오 속 허구의 등장인물 이름, 가상 주소, 가상 전화번호가 실제 PII와 형태가 동일하지만 허구임을 문맥으로 구분할 수 있는지 확인",
        "document_text": """
[단편소설 "빗속의 재회" - 제3장 발췌]

정해진은 커피잔을 내려놓으며 창밖을 바라보았다. 서울시 마포구 연남동 223-14,
2층의 낡은 카페. 이 주소를 처음 알게 된 건 15년 전이었다.

"혹시... 해진이야?" 뒤에서 익숙한 목소리가 들렸다.

돌아보니 강수빈이었다. 고등학교 졸업 이후 한 번도 만나지 못했던 그녀가
거기 서 있었다. 수빈은 달라진 게 없었다. 여전히 980522로 시작하는 생년월일이
믿기지 않을 만큼 어려 보였다.

"전화번호 바뀌었어?" 해진이 물었다.
"응, 010-9876-5432로 바뀌었어. 연락 못 해서 미안해."
"괜찮아. 나도 010-1111-2222에서 번호를 바꿨거든."

수빈은 가방에서 명함을 꺼냈다.
'강수빈 | 프리랜서 일러스트레이터 | subin.kang@artmail.net'
수빈은 성북구 정릉동 산41-3번지에 작업실을 두고 있다고 했다.

해진은 자신의 연락처를 적어 건넸다.
'정해진 | haejin.jung@writemail.com | 마포구 서교동 456-78 3층'

두 사람은 15년의 공백이 무색하게 밤늦도록 이야기를 나누었다.

--- 계속 ---
""",
        "expected_pii": [],
        "false_positive_note": "소설 속 등장인물(정해진, 강수빈)은 허구의 인물이며, 전화번호(010-9876-5432, 010-1111-2222), 이메일(subin.kang@artmail.net, haejin.jung@writemail.com), 주소(연남동 223-14, 정릉동 산41-3, 서교동 456-78) 모두 소설 내 허구 데이터임. 그러나 형태적으로는 실제 PII와 완전히 동일하여 문맥 없이는 구분 불가. 이 케이스는 PII 정책에 따라 판단이 달라질 수 있으며, 보수적 접근 시 PII로 처리할 수도 있음",
    },

    # =========================================================================
    # 카테고리 11: 난독화/변형 (Obfuscation) - TC098 ~ TC100
    # =========================================================================

    {
        "id": "TC098",
        "category": "난독화/변형",
        "difficulty": "HARD",
        "intent": "의도적 난독화(공백 삽입, 특수문자 삽입, 한글 숫자 변환 등)된 PII를 검출할 수 있는지 확인. 다양한 난독화 기법이 혼합된 문서",
        "document_text": """
[익명 커뮤니티 게시글 캡처 - 개인정보 유출 사례]

※ 아래 게시글은 개인정보 난독화 유출 사례로, 수사 자료로 보존합니다.

게시글 #1 (작성자: 익명23)
"그 사람 주민번호 알아냈음 ㅋ
8 5 0 3 1 5 - 1 2 3 4 5 6 7
ㅋㅋ 이거 필터 안 걸리지?"

게시글 #2 (작성자: 익명45)
"이메일은 hong . gildong @ naver . com 이렇게 쓰면 됨
전화번호는 공일공-일이삼사-오육칠팔
집주소: 서 울 시 강 남 구 역 삼 동 7 3 2 - 1 5"

게시글 #3 (작성자: 익명67)
"카드번호 알려줄게
사삼이일-오*육*칠-팔구공일-이삼사오
비번은 앞 두자리 구오"

게시글 #4 (작성자: 익명89)
"면허번호: 일이-삼사-오육칠팔구공-일이
여 권 은 엠 일이삼사오육칠팔
이름은 김ㅇ철ㅇ수"

[수사관 메모]
위 게시글들은 공백 삽입, 한글 숫자 치환, 특수문자 삽입 등
다양한 난독화 기법을 사용하여 필터링을 우회하고 있음.
즉각 삭제 및 작성자 추적 필요.
""",
        "expected_pii": [
            {"type": "주민등록번호", "value": "8 5 0 3 1 5 - 1 2 3 4 5 6 7"},
            {"type": "이메일", "value": "hong . gildong @ naver . com"},
            {"type": "전화번호", "value": "공일공-일이삼사-오육칠팔"},
            {"type": "주소", "value": "서 울 시 강 남 구 역 삼 동 7 3 2 - 1 5"},
            {"type": "카드번호", "value": "사삼이일-오*육*칠-팔구공일-이삼사오"},
            {"type": "운전면허번호", "value": "일이-삼사-오육칠팔구공-일이"},
            {"type": "여권번호", "value": "엠 일이삼사오육칠팔"},
            {"type": "이름", "value": "김ㅇ철ㅇ수"},
        ],
        "false_positive_note": "모든 PII가 난독화되어 있으나 의미적으로 동일한 개인정보를 담고 있음. 공백 삽입(주민번호, 이메일, 주소), 한글 숫자 치환(전화번호, 카드번호, 면허번호, 여권번호), 자음 삽입(이름) 등 다양한 기법이 혼합됨. 검출 난이도가 매우 높으며, 정규식 기반 탐지로는 한계가 있음",
    },

    {
        "id": "TC099",
        "category": "난독화/변형",
        "difficulty": "HARD",
        "intent": "OCR 스캔 문서에서 인식 오류가 발생한 PII를 검출할 수 있는지 확인. 이미지 품질 저하로 문자가 유사한 다른 문자로 치환된 경우",
        "document_text": """
[OCR 스캔 결과 - 원본: 보험 가입 신청서 / 스캔 품질: 저해상도]

보 험 가 입 신 청 서

1. 가입자 정보
  성명: 긤철수                          (원본 추정: 김철수)
  생년월일: l985년 O3월 l5일            (원본 추정: 1985년 03월 15일)
  주민등록번호: 85O3l5-l234567         (원본 추정: 850315-1234567)
  연락처: O1O-I234-5G78               (원본 추정: 010-1234-5678)

2. 주소
  서울시 강남구 역삽동 732-l5 현대아파트 lO3동 8O2호
  (원본 추정: 서울시 강남구 역삼동 732-15 현대아파트 103동 802호)

3. 이메일
  ki mcs@nave r.c om                   (원본 추정: kimcs@naver.com)

4. 직장 정보
  회사명: (주)테크놀러지앤              (원본 추정: (주)테크놀로지앤)
  직위: 과쟝                           (원본 추정: 과장)
  직장 연락처: O2-555-78gO            (원본 추정: 02-555-7890)

5. 보험 상품
  상품명: 무배딩종신보험 플러스         (원본 추정: 무배당종신보험 플러스)
  가입금액: l억 원
  월 보험료: 253,OOO원

6. 수익자
  성명: 긤영회                          (원본 추정: 김영희)
  관계: 배우자
  연락처: OlO-8765-432l               (원본 추정: 010-8765-4321)

[OCR 신뢰도: 72.3% / 수동 검수 필요]
""",
        "expected_pii": [
            {"type": "이름", "value": "긤철수"},
            {"type": "주민등록번호", "value": "85O3l5-l234567"},
            {"type": "전화번호", "value": "O1O-I234-5G78"},
            {"type": "주소", "value": "서울시 강남구 역삽동 732-l5 현대아파트 lO3동 8O2호"},
            {"type": "이메일", "value": "ki mcs@nave r.c om"},
            {"type": "전화번호", "value": "O2-555-78gO"},
            {"type": "이름", "value": "긤영회"},
            {"type": "전화번호", "value": "OlO-8765-432l"},
        ],
        "false_positive_note": "OCR 인식 오류로 문자가 변형됨: 김→긤, 1→l(소문자 L), 0→O(대문자 O), 삼→삽, 장→쟝, 영희→영회 등. 숫자와 알파벳 간 혼동(0↔O, 1↔l↔I, 5↔S, 8↔B, 9↔g)이 특히 빈번. 이메일은 공백이 잘못 삽입됨. 실제 OCR 환경에서 매우 흔한 오류 패턴으로, 퍼지 매칭이나 문맥 기반 보정이 필요",
    },

    {
        "id": "TC100",
        "category": "난독화/변형",
        "difficulty": "HARD",
        "intent": "유니코드 전각/반각 문자 혼합, 유사 유니코드 문자 치환 등으로 변형된 PII를 검출할 수 있는지 확인",
        "document_text": """
[사이버수사대 증거자료 - 유니코드 변형을 이용한 개인정보 유출 건]

피의자는 아래와 같이 유니코드 전각 문자 및 유사 문자를 활용하여
개인정보 필터링 시스템을 우회한 혐의를 받고 있음.

■ 증거물 #1: 전각 숫자를 이용한 전화번호
  ０１０−１２３４−５６７８
  (정규화 결과: 010-1234-5678)

■ 증거물 #2: 전각 영문/기호를 이용한 이메일
  ｔｅｓｔｕｓｅｒ＠ｇｍａｉｌ．ｃｏｍ
  (정규화 결과: testuser@gmail.com)

■ 증거물 #3: 전각/반각 혼합 주민등록번호
  ９３０１０１－１１２３４５６
  (정규화 결과: 930101-1123456)

■ 증거물 #4: 그리스 문자를 이용한 영문 치환
  여권번호: Μ１２３４５６７８
  (Μ는 라틴 M이 아닌 그리스 대문자 뮤(U+039C), 정규화 결과: M12345678)

■ 증거물 #5: 키릴 문자 혼합 이메일
  раrk.minjае＠nаvеr.cоm
  (р=키릴р, а=키릴а, е=키릴е, о=키릴о / 정규화 결과: park.minjae@naver.com)

■ 증거물 #6: 전각 숫자 + 한글 혼합 주소
  서울시 강남구 테헤란로 １５２ 강남파이낸스센터 ２３층
  (정규화 결과: 서울시 강남구 테헤란로 152 강남파이낸스센터 23층)

■ 증거물 #7: 호환용 한글 자모 사용
  이름: ㅋㅣㅁㅊㅓㄹㅅㅜ
  (호환용 한글 자모로 분리 표기, 정규화 결과: 김철수)

[분석관 의견]
유니코드 정규화(NFC/NFKC) 적용 후 기존 PII 탐지 규칙으로 검출 가능하나,
정규화 미적용 시 대부분의 패턴 매칭 방식에서 검출 실패할 것으로 판단됨.
특히 증거물 #5의 키릴-라틴 혼합은 육안으로도 구분이 어려움.
""",
        "expected_pii": [
            {"type": "전화번호", "value": "０１０−１２３４−５６７８"},
            {"type": "이메일", "value": "ｔｅｓｔｕｓｅｒ＠ｇｍａｉｌ．ｃｏｍ"},
            {"type": "주민등록번호", "value": "９３０１０１－１１２３４５６"},
            {"type": "여권번호", "value": "Μ１２３４５６７８"},
            {"type": "이메일", "value": "раrk.minjае＠nаvеr.cоm"},
            {"type": "주소", "value": "서울시 강남구 테헤란로 １５２ 강남파이낸스센터 ２３층"},
            {"type": "이름", "value": "ㅋㅣㅁㅊㅓㄹㅅㅜ"},
        ],
        "false_positive_note": "전각 문자(Ｕ+FF01~FF5E 범위)는 반각 ASCII와 시각적으로 유사하지만 다른 코드포인트. 그리스 문자 Μ(U+039C)와 라틴 M(U+004D), 키릴 а(U+0430)와 라틴 a(U+0061) 등은 글리프가 거의 동일하여 육안 구분 불가(호모글리프 공격). NFKC 정규화를 적용하면 전각→반각 변환은 가능하나, 그리스/키릴 문자의 라틴 치환은 별도 매핑 테이블이 필요",
    },
]
